<!DOCTYPE html><html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Organizador de Parciales DIAMANTE</title>
<style>
:root{--bg:#f4f6f8;--card:#fff;--text:#000;--accent:#7c4dff;--danger:#e53935}
body.dark{--bg:#0f0f14;--card:#1b1b25;--text:#fff}
body{font-family:Arial,sans-serif;background:var(--bg);color:var(--text);padding:20px}
h1{text-align:center}
.card{background:var(--card);padding:15px;border-radius:18px;margin-bottom:20px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
input,button,select,textarea{padding:8px;margin:5px 0;width:100%;border-radius:10px;border:1px solid #ccc}
button{background:var(--accent);color:#fff;border:none}
button.secondary{background:#999}
button.danger{background:var(--danger)}
ul{list-style:none;padding:0}
li{margin:4px 0}
.done{text-decoration:line-through;color:gray}
.parcial{border:1px solid #ccc;border-radius:16px;padding:12px;margin-bottom:15px}
.progress{height:8px;background:#ddd;border-radius:10px;overflow:hidden}
.progress div{height:100%;background:var(--accent)}
.badge{display:inline-block;background:var(--accent);color:#fff;padding:2px 8px;border-radius:20px;font-size:12px}
.today{font-weight:bold}
.note{font-size:12px;opacity:.8}
.crisis{border:2px solid var(--danger)}
</style>
</head>
<body>
<h1>ğŸ’ Organizador de Parciales DIAMANTE</h1><div class="card">
<button onclick="toggleDark()">ğŸŒ™ / â˜€ï¸ Modo oscuro</button>
<p>ğŸ”¥ Racha: <span id="racha">0</span> dÃ­as</p>
</div><div class="card">
<h2>Nuevo parcial</h2>
<input id="nombreParcial" placeholder="Nombre del parcial" />
<input id="fechaParcial" type="date" />
<button onclick="crearParcial()">Crear parcial</button>
</div><div id="contenedorParciales"></div><script>
let parciales=JSON.parse(localStorage.getItem('parciales'))||[];
let dark=localStorage.getItem('dark')==='true';
let racha=Number(localStorage.getItem('racha')||0);
let ultimo=localStorage.getItem('ultimoDia');
if(dark)document.body.classList.add('dark');
document.getElementById('racha').innerText=racha;

function guardar(){localStorage.setItem('parciales',JSON.stringify(parciales));localStorage.setItem('dark',dark);localStorage.setItem('racha',racha);localStorage.setItem('ultimoDia',ultimo)}
function toggleDark(){dark=!dark;document.body.classList.toggle('dark');guardar()}

function crearParcial(){if(!nombreParcial.value||!fechaParcial.value)return;parciales.push({nombre:nombreParcial.value,fecha:fechaParcial.value,temas:[]});nombreParcial.value='';fechaParcial.value='';guardar();render()}

function agregarTema(p){const n=document.getElementById(`tema-${p}`).value;const pr=document.getElementById(`prio-${p}`).value;const nt=document.getElementById(`nota-${p}`).value;if(!n)return;parciales[p].temas.push({nombre:n,hecho:false,prioridad:pr,nota:nt});guardar();render()}

function toggleTema(p,t){parciales[p].temas[t].hecho=!parciales[p].temas[t].hecho;actualizarRacha();guardar();render()}

function actualizarRacha(){const hoy=new Date().toDateString();if(ultimo!==hoy){racha++;ultimo=hoy}}

function dday(f){return Math.ceil((new Date(f)-new Date())/(1000*60*60*24))}
function progreso(p){if(!p.temas.length)return 0;return Math.round((p.temas.filter(t=>t.hecho).length/p.temas.length)*100)}

function hoyToca(p){let pendientes=p.temas.filter(t=>!t.hecho);
  pendientes.sort((a,b)=>({alta:0,media:1,baja:2}[a.prioridad]-({alta:0,media:1,baja:2}[b.prioridad])));
  const d=dday(p.fecha);if(d<=0)return[];const porDia=Math.ceil(pendientes.length/d);
  return pendientes.slice(0,porDia);
}

function render(){contenedorParciales.innerHTML='';parciales.forEach((p,i)=>{
  const prog=progreso(p);const hoy=hoyToca(p);const crisis=dday(p.fecha)<=3?'crisis':'';
  const div=document.createElement('div');div.className='parcial '+crisis;
  div.innerHTML=`<h3>${p.nombre} <span class='badge'>${dday(p.fecha)} dÃ­as</span></h3>
  <div class='progress'><div style='width:${prog}%'></div></div>
  <p>${prog}% completado</p>
  <p class='today'>ğŸ“Œ Hoy estudiar: ${hoy.length?hoy.map(t=>t.nombre).join(', '):'Nada ğŸ‰'}</p>
  <input id='tema-${i}' placeholder='Tema'/>
  <select id='prio-${i}'><option value='alta'>ğŸ”´ Alta</option><option value='media'>ğŸŸ¡ Media</option><option value='baja'>ğŸŸ¢ Baja</option></select>
  <textarea id='nota-${i}' placeholder='Nota rÃ¡pida'></textarea><button onclick='agregarTema(${i})'>Agregar tema</button>

  <ul>${p.temas.map((t,j)=>`<li><input type='checkbox' ${t.hecho?'checked':''} onchange='toggleTema(${i},${j})'/> <span class='${t.hecho?'done':''}'>${t.nombre}</span> <span class='note'>(${t.prioridad}) ${t.nota||''}</span></li>`).join('')}</ul>`;
  contenedorParciales.appendChild(div);
})}
render();
</script>
</body>
</html>
  
